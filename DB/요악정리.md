# 1. SQL Query

1.countries 테이블을 생성

```sql
CREATE TABLE countries (
room_num TEXT NOT NULL,
check_in TEXT NOT NULL,
check_out TEXT NOT NULL,
grade TEXT NOT NULL,
price INT NOT NULL
);
```

2.데이터 입력

```sql
INSERT INTO countries VALUES ('B203', '2019-12-31', '2020-01-03', 'suite', '900');
INSERT INTO countries VALUES ('1102', '2020-01-04', '2020-01-08', 'suite', '850');
INSERT INTO countries VALUES ('303', '2020-01-01', '2020-01-03', 'deluxe', '500');
INSERT INTO countries VALUES ('807', '2020-01-04', '2020-01-07', 'superior', '300');

```

3.테이블 이름 변경

```sql
ALTER TABLE countries RENAME TO hotels;
```

4.객실가격을 내림차순으로 정렬하여 상위 2개 roo_num 과 price를 조회

```sql
SELECT room_num, price FROM hotels ORDER BY 'price' DESC LIMIT 2;
```

5.grade 별로 분류하고 분류된 grade 개수를 내림차순으로 조회하시오.

```sql
SELECT grade, count(grade) FROM hotels GROUP BY grade ORDER BY count(grade) DESC;
```

6.객실의 위치가 지하 혹은 등급이 deluxe인 객식의 모든 정보를 조회

```sql
SELECT * FROM hotels WHERE (grade='deluxe' or room_num LIKE 'B%');
```

7.지상층객실 이면서 2020년 1월 4일에 체크인 한 객실의 목록은 price 오름차순으로 조회

```sql
SELECT room_num FROM hotels WHERE (room_num!='B%' AND check_in='2020-01-04') ORDER BY price ASC; 
```

# 2. SQL ORM

1.user 테이블 전체 데이터 조회

```sql
 User.objects.all()
```

2.id가 19인 사람의 age를 조회

```sql
User.objects.filter(id=19).values('age')

```

3.모든 사람의 age 조회

```sql
User.objects.all().values('age')
```

4.age가 40이하인 사람들의 .id 와 balance를 조회하시오

```sql
User.objects.filter(age__lte=40).values('id', 'balance')
```

5.last_name이 '김'이고 balance가 500 이상인 사람들의 first_name을 조회

```sql
 User.objects.filter(last_name='김', balance__gte=500).values('first_name') 
```

6.first_name이 '수'로 끝나면서 행정구역이 경기도인 사람들의 balance를 조회tn

```sql
User.objects.filter(first_name__endswith='수', country='경기도').values('balance')
```

7.balance가 2000 이상이거나 age 가 40 이하인 사람의 총 인원 수

```sql
User.objects.filter(Q(balance__gte=2000) | Q(age__gte=40)).count()
```

8.Phone 앞자리가 010으로 시작하는 사람의 총원은

```sql
User.objects.filter(phone__startswith='010').count()
```

9.이름이 김옥자인 사람의 행정구역을 경기도로 수정

```sql
user = User.objects.get(last_name='김', first_name='옥자')
user.country = '경기도'
user.save()
```

10.이름이 백진호인 사람을 삭제하시오

```sql
User.objects.get(last_name='백', first_name='진호').delete()

```

11.balance를 기준으로 상위 4명의 first_name, last_name, balance를 조회

```sql
User.objects.order_by('-balance')[:4].values('first_name', 'last_name', 'balance')
```

12.phone에 123을 포함하고 age 가 30미만인 정보를 조회

```sql
User.objects.filter(phone__contains='123', age__lt=30)
```

13.phone이 010으로 시작하는 사람들의 행정 구역을 중복없이 조회

```sql
User.objects.filter(phone__startswith='010').values('country').distinct() 
```

14.모든 인원의 평균 age

```sql
User.objects.aggregate(Avg('age')
```

15.박씨의 평균 balance

```sql'
User.objects.filter(last_name='박').aggregate(Avg('balance'))
```

16.경상북도에 사는 사람 중 가장 많은 balance의 액수

```sql
User.objects.filter(country='경상북도').aggregate(Max('balance'))
```

17.제주특별자치도에 사는 사람중 balance가 가장 많은 사람의 first_name

```slq
User.objects.filter(country='제주특별자치도').order_by('-balance').values('first_name')[0]
```

